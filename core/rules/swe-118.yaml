rules:
  - id: swe-118
    patterns:
      - pattern: contract $C {...}
      - pattern-not: |
          contract $C {
            ...
            function $C(...) {
              ...
            }
            ...
          }
      - pattern-not: |
          contract $C {
            ...
            constructor(...) {
              ...
            }
            ...
          }
      - focus-metavariable: $C
    message: A function meant to become a constructor becomes a normal, callable
      function if its name doesn't exactly match the contract name. This
      behavior sometimes leads to security issues, in particular when smart
      contract code is re-used with a different name but the name of the
      constructor function is not changed accordingly.
    languages:
      - solidity
    severity: WARNING
    metadata:
      references:
        - https://swcregistry.io/docs/SWC-118/#incorrect_constructor_name1sol
        - https://cwe.mitre.org/data/definitions/665.html
      category: security
      cwe:
        - "CWE 665: Improper Initialization"


